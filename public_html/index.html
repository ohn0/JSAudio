<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            #divAudio{
                min-width: 80%;
                margin: auto;
                text-align: center;
            }

            #divData{
                border-style: solid;
                border-width: 1px;
                min-width: 0px;
                min-height: 20vh;
                /*margin: auto;*/
                text-align: center;
            }
        </style>
    </head>
    <body>
        <div id="divAudio">
            <audio id="audioSrc" controls="" >
                <source src="music/09_comouflage.mp3">
            </audio>
        </div>
        <div id="divData"></div>
        <script>
            "use strict";
            function LOG(value){
                console.log(value);
            }
            var divData = document.getElementById("divData");
            divData.style.backgroundColor = 'green';
            var audio = document.getElementById("audioSrc");
            var audioCtx = new AudioContext();
            var analyser = audioCtx.createAnalyser();
            var source = audioCtx.createMediaElementSource(audio);
            source.connect(analyser);
            analyser.connect(audioCtx.destination);
            analyser.fftSize = 32;
            
            var freqData = new Uint8Array(analyser.frequencyBinCount);
            var floatFreqData = new Float32Array(analyser.frequencyBinCount);
            setInterval(function(){
                analyser.getByteFrequencyData(freqData);
                analyser.getFloatFrequencyData(floatFreqData);
                
                divData.style.width = freqData[8]+"px" || 0;
            }, 50);
        </script>
    </body>
</html>
